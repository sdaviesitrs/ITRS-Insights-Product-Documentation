<?xml version="1.0" encoding="utf-8"?>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:lastBlockDepth="10" MadCap:lastHeight="5020" MadCap:lastWidth="1129">
    <head>
        <link href="" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <h1><MadCap:variable name="General.Product Name&#160;Insights (Full)" /> Query,&#160;Search&#160;and Transform Data User Guide</h1>
        <h2 class="nokeyline">Introduction</h2>
        <p><MadCap:variable name="General.Product Name&#160;Insights (Full)" /> provides you with two powerful tools for analyzing and searching your data:</p>
        <ul>
            <li>
                <MadCap:snippetText src="../Resources/Snippets/About Free Text Search.flsnp" />
            </li>
            <li>
                <MadCap:snippetText src="../Resources/Snippets/Definition Query.flsnp" /> </li>
        </ul>
        <p>You, or your administrator, will have chosen what type of repository to use when your data stream was set up, but it's worth you knowing what type of repository you're going to search or query. </p>
        <p>Both methods are incredibly simple to use, but bear in mind the following key consideration:</p>
        <blockquote>
            <p><MadCap:variable name="General.Product Name Insights&#160;(abbreviated)" /> queries data in a pipeline. So, you can run a query, then run another query on the results of the first query. If you have multiple queries lined up in a <strong class="green">notepad</strong>, they will be applied sequentially to the results of each prior query. </p>
        </blockquote>
        <p>If you have yet to import a data stream into <MadCap:variable name="General.Product Name Insights&#160;(abbreviated)" />, or if you need help figuring out which repository type is best for you, check out our <MadCap:xref href="Data Streams &amp; Schema User Guide.htm">[%=General.Product Name&#160;Insights (Full)%] Importing Data Streams &amp;&#160;Schema User Guide</MadCap:xref>. </p>
        <p>Right, let's get on with running our first query and search.</p>
        <h2><a name="Query"></a>Query Data</h2>
        <p>Before you start, make sure you have:</p>
        <ol>
            <li><MadCap:variable name="General.ProductNameValo" /> running...</li>
        </ol>
        <blockquote>
            <p>
                <MadCap:snippetBlock src="../Resources/Snippets/How To Launch Valo.flsnp" />
            </p>
        </blockquote>
        <ol MadCap:continue="true">
            <li><MadCap:variable name="General.Product Name Insights&#160;(abbreviated)" /> running...</li>
        </ol>
        <blockquote>
            <p>
                <MadCap:snippetBlock src="../Resources/Snippets/How To Launch Insights.flsnp" />
            </p>
        </blockquote>
        <ol MadCap:continue="true">
            <li>...a data stream in an&#160;SSR or TSR</li>
        </ol>
        <p style="text-indent: 0.5in;">Ask your systems administrator if you need help with this bit. </p>
        <h4>The basics</h4>
        <p>Every query starts with a <a href="#id1"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/from.htm">from</MadCap:xref></a> followed by the
entity that you are querying</p>
        <blockquote>
            <div class="system-message"><![CDATA[
            ]]><code>from &lt;stream_name&gt;
</code><![CDATA[        ]]></div>
        </blockquote>
        <p>If you are querying historical data (TSR) then you
also need the operator <tt class="docutils literal">historical</tt> in front of the stream name. If
you are using real-time data streaming in then nothing is needed. For
example:</p>
        <blockquote>
            <div class="system-message"><code>from /streams/hce/electricity/usage</code>
            </div>
        </blockquote>
        <p>or</p>
        <blockquote>
            <p><code>from historical /streams/demo/geneos/cpu</code>
            </p>
        </blockquote>
        <p>Executing just this (by hitting the run button) <img alt="insights_querying_data_image0" src="../Resources/Images/RunButton.png" /> will give you a table of all the contents of the stream <tt class="docutils literal">/streams/demo/geneos/cpu</tt></p>
        <p>Your stream_names may be complex based on your structure so you can
easily copy a stream name to the clip board from your home page</p>
        <p>From the data streams section of your homepage if you hover over the
<img alt="insights_querying_data_image1" src="../Resources/Images/CopyIcon.png" /> icon then you will get the option to copy to clipboard</p>
        <p>
            <img alt="insights_querying_data_image2" src="../Resources/Images/StreamToClipboard.png" />
        </p>
        <p>You can then just paste (CTRL-v) into the query box.</p>
        <hr class="docutils" />
        <p>That is however the most basic of queries a great deal more can be
constructed using the SQL like language that Insights provides. Below is
a table of the available syntax <strong>selecting one in the left column</strong>
will take you a more detailed description including the form and some
examples.</p>
        <table border="1" class="docutils">
            <colgroup>
                <col width="22%" />
                <col width="33%" />
                <col width="45%" />
            </colgroup>
            <thead valign="bottom">
                <tr>
                    <th class="head">Clause</th>
                    <th class="head">Usage</th>
                    <th class="head">Example</th>
                </tr>
            </thead>
            <tbody valign="top">
                <tr>
                    <td>
                        <p class="first"><a href="#id5"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/from.htm">from</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Specifies the stream that will be the source of data for the query.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first">
                            <MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/where.htm">Where</MadCap:xref>
                        </p>
                    </td>
                    <td>Filters data based on a condition which follows.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu WHERE user &gt; 50</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id9"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/select.htm">Select</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Selects which fields should appear in the results.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu SELECT host, user, kernel</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id11"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/aggregation.htm">Aggregation</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Perform aggregate calculations on the data.</td>
                    <td><tt class="docutils literal">FROM HISTORICAL /streams/demo/geneos/cpu SELECT avg(user) AS user, avg(kernel) AS kernel</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id13"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/take.htm">Take</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Limits the Return only a certain number of results.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu TAKE 100</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id15"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/OrderBy.htm">Order By</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Orders results in ascending or descending order.</td>
                    <td><tt class="docutils literal">from historical /streams/demo/geneos/cpu order by host ascending</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id17"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/GroupBy.htm">Group By</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Group and aggregate results into distinct buckets.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu GROUP BY host SELECT host, avg(user) AS user</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id19"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/TimeWindow.htm">Time Window</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Group and aggregate into windows based on a time field in the data.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu WINDOW OF 3 seconds SELECT start, end, avg(user) as user</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id21"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/As.htm">As</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Applies an alias to an output field</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu WHERE user &gt; 50 AS cpu_data</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id23"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/Into.htm">Into</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Gives the query a name so it can be referenced from other queries.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu WHERE user &gt; 50 INTO result</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id25"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/Unique.htm">Unique</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Prevents duplicate rows from appearing in the results.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu SELECT UNIQUE host</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id27"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/Join.htm">Join</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Joins two streams, including over a time window.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu WHERE user &gt; 50 INTO c INNER JOIN r ON c.host == r.host</tt>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p class="first"><a href="#id29"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/Comment.htm">Comment</MadCap:xref></a>
                        </p>
                    </td>
                    <td>Allows descriptive text to be added to a query.</td>
                    <td><tt class="docutils literal">FROM /streams/demo/geneos/cpu TAKE 10 <span class="pre">--</span> This is a comment!</tt>
                    </td>
                </tr>
                <tr>
                    <td>Fuzzy</td>
                    <td>Enables search within a query for SSR Only</td>
                    <td><tt class="docutils literal">FROM /streams/demo/infrastructure/log FUZZY "My_Search_Text*"</tt>
                    </td>
                </tr>
            </tbody>
        </table>
        <p>More information on field identifiers, formats and types can be found here: <MadCap:xref href="../B_Technical Reference/Schema Fields &amp; Types/field_identifiers_and_formats.htm">Field Identifiers and Formats.</MadCap:xref></p>
        <h2><a name="Search"></a>Search Data</h2>
        <h3>Free Text Search</h3>
        <p>The search capability in Insights allows you to do free text search,
similar to an internet search engine it search the contents of the
stream for a particular value or string that you give it. Because of how
searches work and require structured data <strong>You can only do searches on
data in the semi-structured repository (SSR).</strong></p>
        <p>The search results are displayed on return, if there is more that one
stream in which they are found then the streams are show in sections.
For example searching for host "192.168.220.43" in a collection of
streams from ITRS Geneos returns:</p>
        <p>
            <img alt="insights_searching_data_image0" src="../Resources/Images/SearchPanel-1.png" style="width: 570px;height: 340px;" />
        </p>
        <p>In the main panel are displayed the 2 streams in which it is found and
on the right hand side is the taxonomy. You can use this to select a
subset of the results that match, doing this highlights the proportions
on the histogram at the top. So for example if we select
<tt class="docutils literal">Status code 200</tt> we see just those entries on the left and on the
histogram above we can see 253 entries from 12 to 1pm (the number is
shown when hovering over the bar).</p>
        <p>
            <img alt="insights_searching_data_image1" src="../Resources/Images/SearchPanel-2.png" style="width: 575px;height: 341px;" />
        </p>
        <p><strong>You can use the wildcard ``*`` in your search, but the search must
*not* start with it.</strong>
        </p>
        <p>For more information, see: <MadCap:xref href="Dashboard &amp; Notebook User Guide.htm">[%=General.Product Name&#160;Insights (Full)%] Dashboard &amp;&#160;Notebook&#160;User Guide</MadCap:xref>.</p>
        <p>Selected the <tt class="docutils literal">+</tt> that is at the top of the window and select the
<tt class="docutils literal">search</tt> option</p>
        <p>
            <img alt="insights_searching_data_image2" src="../Resources/Images/Search01.png" style="width: 573px;height: 90px;" />
        </p>
        <p>
            <img alt="insights_searching_data_image3" src="../Resources/Images/Search02.png" style="width: 570px;height: 91px;" />
        </p>
        <div class="line-block">
            <div class="line">Type in the text you wish to search for within quotes <tt class="docutils literal">" "</tt> and hit
<tt class="docutils literal">Search</tt>.</div>
            <div class="line">If you want to time limit the boundaries of the search then you can
add a start (first date box) and end (second date box) time and date
for the search.</div>
        </div>
        <div class="section" id="relevance-score">
            <h3>Relevance score</h3>
            <p>A search returns the results sorted by the relevance score. Currently,
the score is calculated using the local index statistics which could
result in skewed results if the data is not uniformly distributed in the
cluster. In the future we will support scoring based on the global index
statistics.</p>
        </div>
        <h2>Search in queries</h2>
        <p>The free text search can also be used in real-time and historical
queries using the <strong>fuzzy</strong> keyword:</p>
        <div class="system-message"><pre class="literal-block" xml:space="preserve">
from /streams/demo/infrastructure/log
fuzzy "gif*"
</pre>
        </div>
        <h3>The difference between search and query</h3>
        <p>Search is basically looking through the data and searching for some
specific text (be it characters, numbers etc.) an returning to you all
the instances where this occurs. A search does not attempt in anyway to
interpret or know the data, just to look at it and match an expression.</p>
        <p>A query on the other hand seeks to in some way understand and work with
the data, so for example in its most basic form a query can look into
data to find instances of a number that is greater than 5. To do this
requires that the system understands what is a number (and what is not)
and the comparative order of the numbers, this is why you can only run
queries on data that has a schema. However that is just the simplistic
of queries, through that manipulation and comparison of the data you can
process and analyse the data in any number of ways. Insights provides
you, as well as the basic manipulation functions, with easy and quick
access to complex and sophisticated algorithms for things such as
anomaly detection and Univariate analysis.</p>
        <h2><a name="Transform"></a>Transform Data</h2>
        <p>The data store in Insights is deliberately immutable so the data from
the original stream can <strong>not</strong> be changed. However it is easy to change
and transform data by using any of the <a href="#id1"><MadCap:xref href="../B_Technical Reference/Query Syntax &amp; Operators/Query Functions.htm">Query&#160;Functions</MadCap:xref></a> creating a derived stream from the
original, whether that original is stored or not.</p>
        <p>So for instance if I have all the flight data for US flights but I want
a stream that has only the airline with the carrier code "AA". I can
issue</p>
        <div class="system-message"><pre class="literal-block" xml:space="preserve">
From historical /streams/demo/usa/flightdata
where UniqueCarrier == "AA"
into myNewStream
</pre>
        </div>
        <p>or with a Geneos stream</p>
        <div class="system-message"><pre class="literal-block" xml:space="preserve">
FROM HISTORICAL /streams/demo/geneos/cpu WHERE max(user, kernel) &gt; 50
</pre>
        </div>
        <p>&#160;</p>
    </body>
</html>